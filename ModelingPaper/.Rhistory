model_output <- run_OLS(full_data = data_subset,
predictors = c("onset", "region", "lat", "year_index"),
y.var = "plant", plant_stat = percentile,
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year,
chosen_intensity = "DC")
print(paste("grid size", grid_size))
selected_output <- as.numeric(c(grid_size, lat_offset, lon_offset,
model_output$onset_coef, model_output$intensity_coef, #model_output$lat_coef,
model_output$R2, model_output$percent_data_used,
model_output$residual_moran_pval, model_output$onset_moran_pval,
model_output$plant_moran_pval,
mean(model_output$prediction_results_elimlocation$RMSE, na.rm = TRUE)
))
if (do_elim_year) {
selected_output <- c(selected_output, mean(model_output$prediction_results_elimyear$RMSE, na.rm = TRUE))
}
print(selected_output)
results <- rbind(results, selected_output)
}
}
}
if (do_elim_year) {
names(results) <- c("grid_size",  "lat_offset", "lon_offset",
"onset_coef", "intensity_coef", #"lat_coef",
"R2", "percent_used", "residual_moran_pval", "onset_moran_pval",
"plant_moran_pval",
"mean_RMSE_elimlocation", "mean_RMSE_elimyear")
}
if (!do_elim_year) {
names(results) <- c("grid_size",  "lat_offset", "lon_offset",
"onset_coef", "intensity_coef", #"lat_coef",
"R2", "percent_used", "residual_moran_pval", "onset_moran_pval",
"plant_moran_pval",
"mean_RMSE_elimlocation")
}
# SAVED RESULTS
#saveRDS(results, "OLS_spatial_sampling_results.rds")
# calculate mean and sd for each grid size x agg scheme, for different grid offsets
results_summary <- results %>%
group_by(grid_size) %>%
summarize(
onset_coef_mean = mean(onset_coef),
onset_coef_sd = sd(onset_coef),
intensity_coef_mean = mean(intensity_coef),
intensity_coef_sd = sd(intensity_coef),
#lat_coef_mean = mean(lat_coef),
#lat_coef_sd = sd(lat_coef),
R2_mean = mean(R2),
R2_sd = sd(R2),
percent_used_mean = mean(percent_used),
percent_used_sd = sd(percent_used),
residual_moran_pval_mean = mean(residual_moran_pval),
residual_moran_pval_sd = sd(residual_moran_pval),
onset_moran_pval_mean = mean(onset_moran_pval),
onset_moran_pval_sd = sd(onset_moran_pval),
plant_moran_pval_mean = mean(plant_moran_pval),
plant_moran_pval_sd = sd(plant_moran_pval),
#RMSE_elimyear_mean = mean(mean_RMSE_elimyear), # TURN OFF IF USE YEAR AS FACTOR
#RMSE_elimyear_sd = sd(mean_RMSE_elimyear), # TURN OFF IF USE YEAR AS FACTOR
RMSE_elimlocation_mean = mean(mean_RMSE_elimlocation),
RMSE_elimlocation_sd = sd(mean_RMSE_elimlocation)
)
if (do_elim_year) {
elim_year_summary <- results %>%
group_by(grid_size) %>%
summarize(
RMSE_elimyear_mean = mean(mean_RMSE_elimyear),
RMSE_elimyear_sd = sd(mean_RMSE_elimyear)
)
results_summary <- cbind(results_summary, elim_year_summary)
}
# compare grid sizes
plot_results_summary <- function(data, x_data, y_data, y_sd, x_label, y_label) {
ggplot(data, mapping = aes(x = x_data, y = y_data)) +
geom_line(data, mapping = aes(x = x_data, y = y_data)) +
geom_errorbar(aes(ymin=y_data-y_sd, ymax=y_data+y_sd), position=position_dodge(0.05)) +
ggtitle(y_label) +
xlab(x_label) +
ylab(y_label)+
theme_bw()
}
# plot results, summarizing for different grid offsets
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$onset_coef_mean,
y_sd = results_summary$onset_coef_sd,
x_label = "grid_size", y_label = "onset coefficient")
results_summary
colnames(results_summary)
# sampling grid: size choice for OLS (no spatial sampling needed for FE)
# for each sampling grid size (and offset), report spatial autocorrelation, prediction accuracy in new years and locations, percent total data used, coefficients' sensitivity to sampling grid position
# test different grid sizes and aggregation strategies. don't do any offset
do_elim_year = TRUE # TOGGLE TRUE IF USE YEAR AS TREND, FALSE IF USE YEAR AS FIXED EFFECT
results <- data.frame()
for (grid_size in seq(0.5, 0.75, 0.25)) { # 0.25 to 1.75, seq(0.75, 1.25, 0.25)
for (lat_offset in seq(0, 0.25, by = 0.25)) { # 0 to 1.5
for (lon_offset in seq(0, 0.25, by = 0.25)) { # 0 to 1.5
data_subset = cell_sf_tidy[(cell_sf_tidy$intensity == intensity) & (cell_sf_tidy$plant_stat_type == percentile), ]
model_output <- run_OLS(full_data = data_subset,
predictors = c("onset", "region", "lat", "year_index"),
y.var = "plant", plant_stat = percentile,
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year,
chosen_intensity = "DC")
print(paste("grid size", grid_size))
selected_output <- as.numeric(c(grid_size, lat_offset, lon_offset,
model_output$onset_coef, model_output$intensity_coef, #model_output$lat_coef,
model_output$R2, model_output$percent_data_used,
model_output$residual_moran_pval, model_output$onset_moran_pval,
model_output$plant_moran_pval,
mean(model_output$prediction_results_elimlocation$RMSE, na.rm = TRUE)
))
if (do_elim_year) {
selected_output <- c(selected_output, mean(model_output$prediction_results_elimyear$RMSE, na.rm = TRUE))
}
print(selected_output)
results <- rbind(results, selected_output)
}
}
}
if (do_elim_year) {
names(results) <- c("grid_size",  "lat_offset", "lon_offset",
"onset_coef", "intensity_coef", #"lat_coef",
"R2", "percent_used", "residual_moran_pval", "onset_moran_pval",
"plant_moran_pval",
"mean_RMSE_elimlocation", "mean_RMSE_elimyear")
}
if (!do_elim_year) {
names(results) <- c("grid_size",  "lat_offset", "lon_offset",
"onset_coef", "intensity_coef", #"lat_coef",
"R2", "percent_used", "residual_moran_pval", "onset_moran_pval",
"plant_moran_pval",
"mean_RMSE_elimlocation")
}
# SAVED RESULTS
#saveRDS(results, "OLS_spatial_sampling_results.rds")
# calculate mean and sd for each grid size x agg scheme, for different grid offsets
results_summary <- results %>%
group_by(grid_size) %>%
summarize(
onset_coef_mean = mean(onset_coef),
onset_coef_sd = sd(onset_coef),
intensity_coef_mean = mean(intensity_coef),
intensity_coef_sd = sd(intensity_coef),
#lat_coef_mean = mean(lat_coef),
#lat_coef_sd = sd(lat_coef),
R2_mean = mean(R2),
R2_sd = sd(R2),
percent_used_mean = mean(percent_used),
percent_used_sd = sd(percent_used),
residual_moran_pval_mean = mean(residual_moran_pval),
residual_moran_pval_sd = sd(residual_moran_pval),
onset_moran_pval_mean = mean(onset_moran_pval),
onset_moran_pval_sd = sd(onset_moran_pval),
plant_moran_pval_mean = mean(plant_moran_pval),
plant_moran_pval_sd = sd(plant_moran_pval),
#RMSE_elimyear_mean = mean(mean_RMSE_elimyear), # TURN OFF IF USE YEAR AS FACTOR
#RMSE_elimyear_sd = sd(mean_RMSE_elimyear), # TURN OFF IF USE YEAR AS FACTOR
RMSE_elimlocation_mean = mean(mean_RMSE_elimlocation),
RMSE_elimlocation_sd = sd(mean_RMSE_elimlocation)
)
if (do_elim_year) {
elim_year_summary <- results %>%
group_by(grid_size) %>%
summarize(
RMSE_elimyear_mean = mean(mean_RMSE_elimyear),
RMSE_elimyear_sd = sd(mean_RMSE_elimyear)
)
results_summary <- cbind(results_summary, elim_year_summary)
}
# compare grid sizes
plot_results_summary <- function(data, x_data, y_data, y_sd, x_label, y_label) {
ggplot(data, mapping = aes(x = x_data, y = y_data)) +
geom_line(data, mapping = aes(x = x_data, y = y_data)) +
geom_errorbar(aes(ymin=y_data-y_sd, ymax=y_data+y_sd), position=position_dodge(0.05)) +
ggtitle(y_label) +
xlab(x_label) +
ylab(y_label)+
theme_bw()
}
# plot results, summarizing for different grid offsets
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$onset_coef_mean,
y_sd = results_summary$onset_coef_sd,
x_label = "grid_size", y_label = "onset coefficient")
results_summary
results
ggplot(results_summary, mapping = aes(x = grid_size, y = onset_coef_mean)) +
geom_line(data, mapping = aes(x = grid_size, y = onset_coef_mean))
ggplot(results_summary, mapping = aes(x = grid_size, y = onset_coef_mean)) +
geom_line(results_summary, mapping = aes(x = grid_size, y = onset_coef_mean))
colnames(results_summary) <- make.unique(names(results_summary))
ggplot(results_summary, mapping = aes(x = grid_size, y = onset_coef_mean)) +
geom_line(results_summary, mapping = aes(x = grid_size, y = onset_coef_mean))
# sampling grid: size choice for OLS (no spatial sampling needed for FE)
# for each sampling grid size (and offset), report spatial autocorrelation, prediction accuracy in new years and locations, percent total data used, coefficients' sensitivity to sampling grid position
# test different grid sizes and aggregation strategies. don't do any offset
do_elim_year = TRUE # TOGGLE TRUE IF USE YEAR AS TREND, FALSE IF USE YEAR AS FIXED EFFECT
results <- data.frame()
for (grid_size in seq(0.5, 0.75, 0.25)) { # 0.25 to 1.75, seq(0.75, 1.25, 0.25)
for (lat_offset in seq(0, 0.25, by = 0.25)) { # 0 to 1.5
for (lon_offset in seq(0, 0.25, by = 0.25)) { # 0 to 1.5
data_subset = cell_sf_tidy[(cell_sf_tidy$intensity == intensity) & (cell_sf_tidy$plant_stat_type == percentile), ]
model_output <- run_OLS(full_data = data_subset,
predictors = c("onset", "region", "lat", "year_index"),
y.var = "plant", plant_stat = percentile,
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year,
chosen_intensity = "DC")
print(paste("grid size", grid_size))
selected_output <- as.numeric(c(grid_size, lat_offset, lon_offset,
model_output$onset_coef,
model_output$R2, model_output$percent_data_used,
model_output$residual_moran_pval, model_output$onset_moran_pval,
model_output$plant_moran_pval,
mean(model_output$prediction_results_elimlocation$RMSE, na.rm = TRUE)
))
if (do_elim_year) {
selected_output <- c(selected_output, mean(model_output$prediction_results_elimyear$RMSE, na.rm = TRUE))
}
print(selected_output)
results <- rbind(results, selected_output)
}
}
}
if (do_elim_year) {
names(results) <- c("grid_size",  "lat_offset", "lon_offset", "onset_coef",
"R2", "percent_used", "residual_moran_pval", "onset_moran_pval",
"plant_moran_pval",
"mean_RMSE_elimlocation", "mean_RMSE_elimyear")
}
if (!do_elim_year) {
names(results) <- c("grid_size",  "lat_offset", "lon_offset", "onset_coef",
"R2", "percent_used", "residual_moran_pval", "onset_moran_pval",
"plant_moran_pval",
"mean_RMSE_elimlocation")
}
# SAVED RESULTS
#saveRDS(results, "OLS_spatial_sampling_results.rds")
# calculate mean and sd for each grid size x agg scheme, for different grid offsets
results_summary <- results %>%
group_by(grid_size) %>%
summarize(
onset_coef_mean = mean(onset_coef),
onset_coef_sd = sd(onset_coef),
R2_mean = mean(R2), R2_sd = sd(R2),
percent_used_mean = mean(percent_used),
percent_used_sd = sd(percent_used),
residual_moran_pval_mean = mean(residual_moran_pval),
residual_moran_pval_sd = sd(residual_moran_pval),
onset_moran_pval_mean = mean(onset_moran_pval),
onset_moran_pval_sd = sd(onset_moran_pval),
plant_moran_pval_mean = mean(plant_moran_pval),
plant_moran_pval_sd = sd(plant_moran_pval),
#RMSE_elimyear_mean = mean(mean_RMSE_elimyear), # TURN OFF IF USE YEAR AS FACTOR
#RMSE_elimyear_sd = sd(mean_RMSE_elimyear), # TURN OFF IF USE YEAR AS FACTOR
RMSE_elimlocation_mean = mean(mean_RMSE_elimlocation),
RMSE_elimlocation_sd = sd(mean_RMSE_elimlocation)
)
if (do_elim_year) {
elim_year_summary <- results %>%
group_by(grid_size) %>%
summarize(
RMSE_elimyear_mean = mean(mean_RMSE_elimyear),
RMSE_elimyear_sd = sd(mean_RMSE_elimyear)
)
results_summary <- cbind(results_summary, elim_year_summary)
}
colnames(results_summary) <- make.unique(names(results_summary))
# compare grid sizes
plot_results_summary <- function(data, x_data, y_data, y_sd, x_label, y_label) {
ggplot(data, mapping = aes(x = x_data, y = y_data)) +
geom_line(data, mapping = aes(x = x_data, y = y_data)) +
geom_errorbar(aes(ymin=y_data-y_sd, ymax=y_data+y_sd), position=position_dodge(0.05)) +
ggtitle(y_label) +
xlab(x_label) +
ylab(y_label)+
theme_bw()
}
# plot results, summarizing for different grid offsets
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$onset_coef_mean,
y_sd = results_summary$onset_coef_sd,
x_label = "grid_size", y_label = "onset coefficient")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$intensity_coef_mean,
y_sd = results_summary$intensity_coef_sd,
x_label = "grid_size", y_label = "intensity coefficient")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$onset_coef_mean,
y_sd = results_summary$onset_coef_sd,
x_label = "grid_size", y_label = "onset coefficient")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$R2_mean,
y_sd = results_summary$R2_sd,
x_label = "grid_size", y_label = "R2")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$percent_used_mean,
y_sd = results_summary$percent_used_sd,
x_label = "grid_size", y_label = "percent used")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$residual_moran_pval_mean,
y_sd = results_summary$residual_moran_pval_sd,
x_label = "grid_size", y_label = "residual moran's I p value")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$onset_moran_pval_mean,
y_sd = results_summary$onset_moran_pval_sd,
x_label = "grid_size", y_label = "onset moran's I p value")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$plant_moran_pval_mean,
y_sd = results_summary$plant_moran_pval_sd,
x_label = "grid_size", y_label = "plant moran's I p value")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$RMSE_elimlocation_mean,
y_sd = results_summary$RMSE_elimlocation_sd,
x_label = "grid_size", y_label = "RMSE from eliminating location")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$RMSE_elimyear_mean,
y_sd = results_summary$RMSE_elimyear_sd,
x_label = "grid_size", y_label = "RMSE from eliminating year")
# sampling grid: size choice for OLS (no spatial sampling needed for FE)
# for each sampling grid size (and offset), report spatial autocorrelation, prediction accuracy in new years and locations, percent total data used, coefficients' sensitivity to sampling grid position
# test different grid sizes and aggregation strategies. don't do any offset
do_elim_year = TRUE # TOGGLE TRUE IF USE YEAR AS TREND, FALSE IF USE YEAR AS FIXED EFFECT
results <- data.frame()
for (grid_size in seq(0.5, 1.5, 0.25)) { # 0.25 to 1.75, seq(0.75, 1.25, 0.25)
for (lat_offset in seq(0, 1.5, by = 0.25)) { # 0 to 1.5
for (lon_offset in seq(0, 1.5, by = 0.25)) { # 0 to 1.5
data_subset = cell_sf_tidy[(cell_sf_tidy$intensity == intensity) & (cell_sf_tidy$plant_stat_type == percentile), ]
model_output <- run_OLS(full_data = data_subset,
predictors = c("onset", "region", "lat", "year_index"),
y.var = "plant", plant_stat = percentile,
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year,
chosen_intensity = "DC")
print(paste("grid size", grid_size))
selected_output <- as.numeric(c(grid_size, lat_offset, lon_offset,
model_output$onset_coef,
model_output$R2, model_output$percent_data_used,
model_output$residual_moran_pval, model_output$onset_moran_pval,
model_output$plant_moran_pval,
mean(model_output$prediction_results_elimlocation$RMSE, na.rm = TRUE)
))
if (do_elim_year) {
selected_output <- c(selected_output, mean(model_output$prediction_results_elimyear$RMSE, na.rm = TRUE))
}
print(selected_output)
results <- rbind(results, selected_output)
}
}
}
results
# sampling grid: size choice for OLS (no spatial sampling needed for FE)
# for each sampling grid size (and offset), report spatial autocorrelation, prediction accuracy in new years and locations, percent total data used, coefficients' sensitivity to sampling grid position
# test different grid sizes and aggregation strategies. don't do any offset
do_elim_year = TRUE # TOGGLE TRUE IF USE YEAR AS TREND, FALSE IF USE YEAR AS FIXED EFFECT
results <- data.frame()
for (grid_size in seq(0.5, 1.5, 0.25)) { # 0.25 to 1.75, seq(0.75, 1.25, 0.25)
for (lat_offset in seq(0, 1.5, by = 0.25)) { # 0 to 1.5
for (lon_offset in seq(0, 1.5, by = 0.25)) { # 0 to 1.5
data_subset = cell_sf_tidy[(cell_sf_tidy$intensity == intensity) & (cell_sf_tidy$plant_stat_type == percentile), ]
model_output <- run_OLS(full_data = data_subset,
predictors = c("onset", "lat", "year_index"),
y.var = "plant", plant_stat = percentile,
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year,
chosen_intensity = "DC")
print(paste("grid size", grid_size))
selected_output <- as.numeric(c(grid_size, lat_offset, lon_offset,
model_output$onset_coef,
model_output$R2, model_output$percent_data_used,
model_output$residual_moran_pval, model_output$onset_moran_pval,
model_output$plant_moran_pval,
mean(model_output$prediction_results_elimlocation$RMSE, na.rm = TRUE)
))
if (do_elim_year) {
selected_output <- c(selected_output, mean(model_output$prediction_results_elimyear$RMSE, na.rm = TRUE))
}
print(selected_output)
results <- rbind(results, selected_output)
}
}
}
if (do_elim_year) {
names(results) <- c("grid_size",  "lat_offset", "lon_offset", "onset_coef",
"R2", "percent_used", "residual_moran_pval", "onset_moran_pval",
"plant_moran_pval",
"mean_RMSE_elimlocation", "mean_RMSE_elimyear")
}
if (!do_elim_year) {
names(results) <- c("grid_size",  "lat_offset", "lon_offset", "onset_coef",
"R2", "percent_used", "residual_moran_pval", "onset_moran_pval",
"plant_moran_pval",
"mean_RMSE_elimlocation")
}
# SAVED RESULTS
saveRDS(results, paste0("OLS_spatial_sampling_results", onset_type, ".rds"))
# calculate mean and sd for each grid size x agg scheme, for different grid offsets
results_summary <- results %>%
group_by(grid_size) %>%
summarize(
onset_coef_mean = mean(onset_coef),
onset_coef_sd = sd(onset_coef),
R2_mean = mean(R2), R2_sd = sd(R2),
percent_used_mean = mean(percent_used),
percent_used_sd = sd(percent_used),
residual_moran_pval_mean = mean(residual_moran_pval),
residual_moran_pval_sd = sd(residual_moran_pval),
onset_moran_pval_mean = mean(onset_moran_pval),
onset_moran_pval_sd = sd(onset_moran_pval),
plant_moran_pval_mean = mean(plant_moran_pval),
plant_moran_pval_sd = sd(plant_moran_pval),
#RMSE_elimyear_mean = mean(mean_RMSE_elimyear), # TURN OFF IF USE YEAR AS FACTOR
#RMSE_elimyear_sd = sd(mean_RMSE_elimyear), # TURN OFF IF USE YEAR AS FACTOR
RMSE_elimlocation_mean = mean(mean_RMSE_elimlocation),
RMSE_elimlocation_sd = sd(mean_RMSE_elimlocation)
)
if (do_elim_year) {
elim_year_summary <- results %>%
group_by(grid_size) %>%
summarize(
RMSE_elimyear_mean = mean(mean_RMSE_elimyear),
RMSE_elimyear_sd = sd(mean_RMSE_elimyear)
)
results_summary <- cbind(results_summary, elim_year_summary)
}
colnames(results_summary) <- make.unique(names(results_summary))
# compare grid sizes
plot_results_summary <- function(data, x_data, y_data, y_sd, x_label, y_label) {
ggplot(data, mapping = aes(x = x_data, y = y_data)) +
geom_line(data, mapping = aes(x = x_data, y = y_data)) +
geom_errorbar(aes(ymin=y_data-y_sd, ymax=y_data+y_sd), position=position_dodge(0.05)) +
ggtitle(y_label) +
xlab(x_label) +
ylab(y_label)+
theme_bw()
}
# plot results, summarizing for different grid offsets
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$onset_coef_mean,
y_sd = results_summary$onset_coef_sd,
x_label = "grid_size", y_label = "onset coefficient")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$R2_mean,
y_sd = results_summary$R2_sd,
x_label = "grid_size", y_label = "R2")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$percent_used_mean,
y_sd = results_summary$percent_used_sd,
x_label = "grid_size", y_label = "percent used")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$residual_moran_pval_mean,
y_sd = results_summary$residual_moran_pval_sd,
x_label = "grid_size", y_label = "residual moran's I p value")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$onset_moran_pval_mean,
y_sd = results_summary$onset_moran_pval_sd,
x_label = "grid_size", y_label = "onset moran's I p value")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$plant_moran_pval_mean,
y_sd = results_summary$plant_moran_pval_sd,
x_label = "grid_size", y_label = "plant moran's I p value")
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$RMSE_elimlocation_mean,
y_sd = results_summary$RMSE_elimlocation_sd,
x_label = "grid_size", y_label = "RMSE from eliminating location")
if (do_elim_year) {
plot_results_summary(data = results_summary,
x_data = results_summary$grid_size, y_data = results_summary$RMSE_elimyear_mean,
y_sd = results_summary$RMSE_elimyear_sd,
x_label = "grid_size", y_label = "RMSE from eliminating year")
}
chosen_grid_size = 0.75
chosen_lat_offset = 0
chosen_lon_offset = 0
chosen_year_oi = 2012
data_subset = cell_sf_tidy[(cell_sf_tidy$intensity == "DC") & (cell_sf_tidy$plant_stat_type == "median"), ]
model_output <- run_OLS(full_data = data_subset, predictors = c("onset", "lat", "year_index", "region"),
y.var = "plant", plant_stat = "median", grid_size = chosen_grid_size,
lat_offset = chosen_lat_offset, lon_offset = chosen_lon_offset, agg_scheme = FALSE,
plot_samples = TRUE, plot_model_evals = FALSE,
year_oi = chosen_year_oi,
do_elim_year = FALSE,
chosen_intensity = "DC")
source(paste0(first_folder,'/R-code2/Modeling/code/FCN_plotting.R'))
chosen_grid_size = 0.75
chosen_lat_offset = 0
chosen_lon_offset = 0
chosen_year_oi = 2014
data_subset = cell_sf_tidy[(cell_sf_tidy$intensity == "DC") & (cell_sf_tidy$plant_stat_type == "median"), ]
model_output <- run_OLS(full_data = data_subset, predictors = c("onset", "lat", "year_index", "region"),
y.var = "plant", plant_stat = "median", grid_size = chosen_grid_size,
lat_offset = chosen_lat_offset, lon_offset = chosen_lon_offset, agg_scheme = FALSE,
plot_samples = TRUE, plot_model_evals = FALSE,
year_oi = chosen_year_oi,
do_elim_year = FALSE,
chosen_intensity = "DC")
