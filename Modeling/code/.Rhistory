onset_coef = numeric(0),
onset_std_err = numeric(0),
year_treatment = character(0),
lat_treatment = character(0),
region_treatment = character(0),
cell_treatment = character(0),
model_type = character(0))
############# model for (1) cell_ID and year_index as FE in panel, (2) onset as predictor ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
print(plant_stat_type)
panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID","year_index"))
panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID","year_index"))
SC_output <- plm(plant ~ onset, data = panel_SC, model = "within")
DC_output <- plm(plant ~ onset, data = panel_DC, model = "within")
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("FE", "FE"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('panel', 'panel'),
lat_treatment = c('none', 'none'),
region_treatment = c('none', 'none'),
cell_treatment = c('panel', 'panel'))
fe_results <- rbind(fe_results, updated_results)
}
############# model for (1) cell_ID and year_index as FE in panel, (2) onset and year_index as predictor ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
print(plant_stat_type)
panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID","year_index"))
panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID","year_index"))
SC_output <- plm(plant ~ onset + year_index, data = panel_SC, model = "within")
DC_output <- plm(plant ~ onset + year_index, data = panel_DC, model = "within")
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("FE", "FE"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('panel_reg', 'panel_reg'),
lat_treatment = c('none', 'none'),
region_treatment = c('none', 'none'),
cell_treatment = c('panel', 'panel'))
fe_results <- rbind(fe_results, updated_results)
}
print(fe_results)
library(plm) # for FE and FE
# # sample from full data and turn into data frame
# sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = "median", grid_size = 0.75,
#                  lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
# st_geometry(sampled_SC) <- NULL
#
# sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = "median", grid_size = 0.75,
#                  lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
# st_geometry(sampled_DC) <- NULL
#
# # for plm, first set data as panel data
# panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID","year_index"))
# panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID","year_index"))
#
# # FE
# fe_result_SC <- plm(plant ~ onset + lat + lon + region, data = panel_SC, model = "within")
# fe_result_DC <- plm(plant ~ onset + lat + lon + region, data = panel_DC, model = "within")
#
# print(fe_result_SC)
# print(fe_result_DC)
# set up data frame to store model results for all models
fe_results <- data.frame(plant_stat_type = numeric(0),
intensity = numeric(0),
model_type = numeric(0),
onset_coef = numeric(0),
onset_std_err = numeric(0),
year_treatment = character(0),
lat_treatment = character(0),
region_treatment = character(0),
cell_treatment = character(0),
model_type = character(0))
############# model for (1) cell_ID and year_index as FE in panel, (2) onset as predictor ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID","year_index"))
panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID","year_index"))
SC_output <- plm(plant ~ onset, data = panel_SC, model = "within")
DC_output <- plm(plant ~ onset, data = panel_DC, model = "within")
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("FE", "FE"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('panel', 'panel'),
lat_treatment = c('none', 'none'),
region_treatment = c('none', 'none'),
cell_treatment = c('panel', 'panel'))
fe_results <- rbind(fe_results, updated_results)
}
############# model for (1) cell_ID as FE in panel, (2) onset and year_index as predictor ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID", "year_index"))
panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID", "year_index"))
SC_output <- plm(plant ~ onset + year_index, data = panel_SC, model = "within")
DC_output <- plm(plant ~ onset + year_index, data = panel_DC, model = "within")
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("FE", "FE"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('panel_reg', 'panel_reg'),
lat_treatment = c('none', 'none'),
region_treatment = c('none', 'none'),
cell_treatment = c('panel', 'panel'))
fe_results <- rbind(fe_results, updated_results)
}
############# model for (1) cell_ID as FE in panel, (2) onset and year_index as predictor ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID"))
panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID"))
SC_output <- plm(plant ~ onset + year_index, data = panel_SC, model = "within")
DC_output <- plm(plant ~ onset + year_index, data = panel_DC, model = "within")
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("FE", "FE"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('reg', 'reg'),
lat_treatment = c('none', 'none'),
region_treatment = c('none', 'none'),
cell_treatment = c('panel', 'panel'))
fe_results <- rbind(fe_results, updated_results)
}
print(fe_results)
library(plm) # for FE and FE
# # sample from full data and turn into data frame
# sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = "median", grid_size = 0.75,
#                  lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
# st_geometry(sampled_SC) <- NULL
#
# sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = "median", grid_size = 0.75,
#                  lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
# st_geometry(sampled_DC) <- NULL
#
# # for plm, first set data as panel data
# panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID", "year_index"))
# panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID", "year_index"))
#
# # FE
# re_result_SC <- plm(plant ~ onset + lat + region + year_index, data = panel_SC, model = "random")
# re_result_DC <- plm(plant ~ onset + lat + region + year_index, data = panel_DC, model = "random")
#
# print(re_result_SC)
# print(re_result_DC)
# set up data frame to store model results for all models
re_results <- data.frame(plant_stat_type = numeric(0),
intensity = numeric(0),
model_type = numeric(0),
onset_coef = numeric(0),
onset_std_err = numeric(0),
year_treatment = character(0),
lat_treatment = character(0),
region_treatment = character(0),
cell_treatment = character(0),
model_type = character(0))
############# model for (1) cell_ID and year_index as FE in panel, (2) onset, region, lat as predictor ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID","year_index"))
panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID","year_index"))
SC_output <- plm(plant ~ onset + lat + region, data = panel_SC, model = "random")
DC_output <- plm(plant ~ onset + lat + region, data = panel_DC, model = "random")
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("RE", "RE"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('panel', 'panel'),
lat_treatment = c('reg', 'reg'),
region_treatment = c('reg', 'reg'),
cell_treatment = c('panel', 'panel'))
re_results <- rbind(re_results, updated_results)
}
print(re_results)
library(plm) # for FE and FE
# # sample from full data and turn into data frame
# sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = "median", grid_size = 0.75,
#                  lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
# st_geometry(sampled_SC) <- NULL
#
# sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = "median", grid_size = 0.75,
#                  lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
# st_geometry(sampled_DC) <- NULL
#
# # for plm, first set data as panel data
# panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID", "year_index"))
# panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID", "year_index"))
#
# # FE
# re_result_SC <- plm(plant ~ onset + lat + region + year_index, data = panel_SC, model = "random")
# re_result_DC <- plm(plant ~ onset + lat + region + year_index, data = panel_DC, model = "random")
#
# print(re_result_SC)
# print(re_result_DC)
# set up data frame to store model results for all models
re_results <- data.frame(plant_stat_type = numeric(0),
intensity = numeric(0),
model_type = numeric(0),
onset_coef = numeric(0),
onset_std_err = numeric(0),
year_treatment = character(0),
lat_treatment = character(0),
region_treatment = character(0),
cell_treatment = character(0),
model_type = character(0))
############# model for (1) cell_ID and year_index as FE in panel, (2) onset, region, lat as predictor ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID","year_index"))
panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID","year_index"))
SC_output <- plm(plant ~ onset + lat + region, data = panel_SC, model = "random")
DC_output <- plm(plant ~ onset + lat + region, data = panel_DC, model = "random")
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("RE", "RE"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('panel', 'panel'),
lat_treatment = c('reg', 'reg'),
region_treatment = c('reg', 'reg'),
cell_treatment = c('panel', 'panel'))
re_results <- rbind(re_results, updated_results)
}
############# model for (1) cell_ID and year_index as FE in panel, (2) onset, region, lat, year_index as predictor ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID","year_index"))
panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID","year_index"))
SC_output <- plm(plant ~ onset + lat + region + year_index, data = panel_SC, model = "random")
DC_output <- plm(plant ~ onset + lat + region + year_index, data = panel_DC, model = "random")
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("RE", "RE"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('panel_reg', 'panel_reg'),
lat_treatment = c('reg', 'reg'),
region_treatment = c('reg', 'reg'),
cell_treatment = c('panel', 'panel'))
re_results <- rbind(re_results, updated_results)
}
############# model for (1) cell_ID as FE in panel, (2) onset, region, lat, year_index as predictor ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
panel_SC <- pdata.frame(sampled_SC,index = c("cell_ID"))
panel_DC <- pdata.frame(sampled_DC,index = c("cell_ID"))
SC_output <- plm(plant ~ onset + lat + region + year_index, data = panel_SC, model = "random")
DC_output <- plm(plant ~ onset + lat + region + year_index, data = panel_DC, model = "random")
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("RE", "RE"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('reg', 'reg'),
lat_treatment = c('reg', 'reg'),
region_treatment = c('reg', 'reg'),
cell_treatment = c('panel', 'panel'))
re_results <- rbind(re_results, updated_results)
}
print(re_results)
library(lme4) # for lmer()
library(nlme) # for lme()
# # sample from full data and turn into data frame
# sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = "median", grid_size = 0.75,
#                  lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
# st_geometry(sampled_SC) <- NULL
#
# sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = "median", grid_size = 0.75,
#                  lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
# st_geometry(sampled_DC) <- NULL
#
# # ME
# me_result_SC <- lmer(plant ~ onset + year_index + (1|cell_ID), data = sampled_SC)
# me_result_DC <- lmer(plant ~ onset + year_index + (1|cell_ID), data = sampled_DC)
#
# print(me_result_SC)
# print(me_result_DC)
#
# # another ME. do nested models to look at effect of additional random effects
# me2_result_SC <- lmer(plant ~ onset + year_index + (1|lat), data = sampled_SC, REML = FALSE)
# me3_result_SC <- lmer(plant ~ onset + year_index + (1|region) + (1|cell_ID), data = sampled_SC, REML = FALSE)
# anova(me2_result_SC, me3_result_SC)
# another ME
#me2_result_SC <- lme(plant ~ onset + year_index, random = ~1|, data = sampled_SC, method = "ML")
#me2_complex_result_SC <- lme(plant ~ onset + year_index, random = ~1|cell_ID, data = sampled_SC, method = "ML")
#anova(me2_result_SC, me2_complex_result_SC)
# set up data frame to store model results for all models
me_results <- data.frame(plant_stat_type = numeric(0),
intensity = numeric(0),
model_type = numeric(0),
onset_coef = numeric(0),
onset_std_err = numeric(0),
year_treatment = character(0),
lat_treatment = character(0),
region_treatment = character(0),
cell_treatment = character(0),
model_type = character(0))
############# model for (1) FE: onset, year, lat, region (2) RE: cell_ID ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
SC_output <- lmer(plant ~ onset + year_index + lat + region + (1|cell_ID), data = sampled_SC)
DC_output <- lmer(plant ~ onset + year_index + lat + region + (1|cell_ID), data = sampled_DC)
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("ME", "ME"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('reg', 'reg'),
lat_treatment = c('reg', 'reg'),
region_treatment = c('reg', 'reg'),
cell_treatment = c('RE', 'RE'))
me_results <- rbind(me_results, updated_results)
}
############# model for (1) FE: onset, year, lat (2) RE: cell_ID, region ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
SC_output <- lmer(plant ~ onset + year_index + lat + (1|region) + (1|cell_ID), data = sampled_SC)
DC_output <- lmer(plant ~ onset + year_index + lat + (1|region) + (1|cell_ID), data = sampled_DC)
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("ME", "ME"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('reg', 'reg'),
lat_treatment = c('reg', 'reg'),
region_treatment = c('RE', 'RE'),
cell_treatment = c('RE', 'RE'))
me_results <- rbind(me_results, updated_results)
}
############# model for (1) FE: onset, year, lat (2) RE: region ####################################
for (plant_stat_type in plant_stat_types) {
sampled_SC <- get_sampled_data(full_data = cell_sf_tidy_SC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_SC) <- NULL
sampled_DC <- get_sampled_data(full_data = cell_sf_tidy_DC, plant_stat = plant_stat_type, grid_size = 0.75,
lat_offset = 0, lon_offset = 0, agg_scheme = FALSE, plot_samples = FALSE, year_oi = 2012)
st_geometry(sampled_DC) <- NULL
SC_output <- lmer(plant ~ onset + year_index + lat + (1|region), data = sampled_SC)
DC_output <- lmer(plant ~ onset + year_index + lat + (1|region), data = sampled_DC)
SC_onset <- summary(SC_output)$coefficients['onset',]['Estimate']
SC_onset_stderr <- summary(SC_output)$coefficients['onset',]['Std. Error']
DC_onset <- summary(DC_output)$coefficients['onset',]['Estimate']
DC_onset_stderr <- summary(DC_output)$coefficients['onset',]['Std. Error']
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("ME", "ME"),
onset_coef = c(as.numeric(SC_onset), as.numeric(DC_onset)),
onset_std_err = c(as.numeric(SC_onset_stderr), as.numeric(DC_onset_stderr)),
year_treatment = c('reg', 'reg'),
lat_treatment = c('reg', 'reg'),
region_treatment = c('RE', 'RE'),
cell_treatment = c('none', 'none'))
me_results <- rbind(me_results, updated_results)
}
print(me_results)
results <- rbind(ols_results, fe_results, re_results, me_results)
plant_stat_types <- c("median", "percentile5", "percentile95")
# set up data frame to store model results for all models
ols_results <- data.frame(plant_stat_type = numeric(0),
intensity = numeric(0),
model_type = numeric(0),
onset_coef = numeric(0),
onset_std_err = numeric(0),
year_treatment = character(0),
lat_treatment = character(0),
region_treatment = character(0),
cell_treatment = character(0),
model_type = character(0))
for (plant_stat_type in plant_stat_types) {
print(plant_stat_type)
SC_output <- run_OLS(full_data = cell_sf_tidy_SC,
predictors = c("onset",
"lat", "lon", "region", # for spatial effects
"year_index" # for time effects
),
y.var = "plant", plant_stat = plant_stat_type,
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "SC")
DC_output <- run_OLS(full_data = cell_sf_tidy_DC,
predictors = c("onset",
"lat", "lon", "region", # for spatial effects
"year_index" # for time effects
),
y.var = "plant", plant_stat = plant_stat_type,
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
print(c(plant_stat_type, "SC", "OLS", as.numeric(SC_output$onset_coef), as.numeric(SC_output$onset_std_err)))
updated_results <- data.frame(plant_stat_type = c(plant_stat_type, plant_stat_type),
intensity = c("SC", "DC"),
model_type = c("OLS", "OLS"),
onset_coef = c(as.numeric(SC_output$onset_coef), as.numeric(DC_output$onset_coef)),
onset_std_err = c(as.numeric(SC_output$onset_std_err), as.numeric(DC_output$onset_std_err)),
year_treatment = c('reg', 'reg'),
lat_treatment = c('reg', 'reg'),
region_treatment = c('reg', 'reg'),
cell_treatment = c('none', 'none'))
ols_results <- rbind(ols_results, updated_results)
}
print(ols_results)
results <- rbind(ols_results, fe_results, re_results, me_results)
results
