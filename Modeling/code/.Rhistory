model_type <- "FE"
model_type %in% c("FE", "ME")
random_vars <- c('a', 'b')
ME_randomEffects <- c('a', 'b')
random_vars <- character(0)
for (var in ME_randomEffects) {
random_vars <- c(random_vars, paste0('(1|', var, ')'))
}
random_vars
formula.string.random <- paste(random_vars, collapse = " + ")
formula.string.regular <- paste('plant', paste(c('blah', 'adfd'), collapse = " + "), sep = " ~ ")
formula.string <- paste(formula.string.regular, formula.string.random, sep = " + ")
f <- as.formula(formula.string)
f
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = TRUE, year_oi = 2012, do_elim_year = TRUE,
chosen_intensity = "DC")
library(ggplot2)
library(tidyverse)
library(broom)
library(dplyr)
library(plyr)
library(rgdal)
library(rgeos)
library(raster)
library(sf)
library(sp)
library(tmap)
library(viridis)
library(spdep)
library(spatialreg)
library(lmtest)
library(Metrics) # for rmse
library(leaflet)
library(leaps) # stepwise model selection
#E:/R-code/Modeling/code/FCN_clean_csvs.R
#~/Documents/R-code
source('E:/R-code/Modeling/code/FCN_clean_csvs.R')
source('E:/R-code/Modeling/code/FCN_plotting.R')
source('E:/R-code/Modeling/code/FCN_sample_data.R')
source('E:/R-code/Modeling/code/FCN_run_model_spatial_sampled.R') # OLS only
source('E:/R-code/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
library(ggplot2)
library(tidyverse)
library(broom)
library(dplyr)
library(plyr)
library(rgdal)
library(rgeos)
library(raster)
library(sf)
library(sp)
library(tmap)
library(viridis)
library(spdep)
library(spatialreg)
library(lmtest)
library(Metrics) # for rmse
library(leaflet)
library(leaps) # stepwise model selection
#E:/R-code/Modeling/code/FCN_clean_csvs.R
#~/Documents/R-code
source('E:/R-code2/Modeling/code/FCN_clean_csvs.R')
source('E:/R-code2/Modeling/code/FCN_plotting.R')
source('E:/R-code2/Modeling/code/FCN_sample_data.R')
source('E:/R-code2/Modeling/code/FCN_run_model_spatial_sampled.R') # OLS only
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
library(ggplot2)
library(tidyverse)
library(broom)
library(dplyr)
library(plyr)
library(rgdal)
library(rgeos)
library(raster)
library(sf)
library(sp)
library(tmap)
library(viridis)
library(spdep)
library(spatialreg)
library(lmtest)
library(Metrics) # for rmse
library(leaflet)
library(leaps) # stepwise model selection
#E:/R-code/Modeling/code/FCN_clean_csvs.R
#~/Documents/R-code
source('E:/R-code2/Modeling/code/FCN_clean_csvs.R')
source('E:/R-code2/Modeling/code/FCN_plotting.R')
source('E:/R-code2/Modeling/code/FCN_sample_data.R')
source('E:/R-code2/Modeling/code/FCN_run_model_spatial_sampled.R') # OLS only
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
MT_outline <- readOGR(dsn = 'E:/R-code2/Modeling/data/shp/MatoGrossoOutline', layer = 'MatoGrossoOutline')
crs(MT_outline) <- CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0")
onset_type <- 'Gabriel_onset'
median_cell_raw <- read.csv('E:/R-code2/Modeling/data/median_onset_cell_v2.csv')
percentile5_cell_raw <- read.csv('E:/R-code2/Modeling/data/percentile5_onset_cell_v2.csv')
percentile95_cell_raw <- read.csv('E:/R-code2/Modeling/data/percentile95_onset_cell_v2.csv')
grid_1deg <- readOGR(dsn = 'E:/R-code2/Modeling/data/shp/grid_1deg', layer = 'grid_1deg')
munis <- readOGR(dsn = 'E:/R-code2/Modeling/data/shp/munis', layer = 'munis_SHP')
crs(munis) <- CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0")
cell_sf <- st_read(dsn = 'E:/R-code/Modeling/data/shp/median_onset_cell', layer = 'median_onset_cell_SHP')
min_soy_area <- 2 #km2. min area of total or SC/DC soy in cell, muni or property to be considered in model
library(ggplot2)
library(tidyverse)
library(broom)
library(dplyr)
library(plyr)
library(rgdal)
library(rgeos)
library(raster)
library(sf)
library(sp)
library(tmap)
library(viridis)
library(spdep)
library(spatialreg)
library(lmtest)
library(Metrics) # for rmse
library(leaflet)
library(leaps) # stepwise model selection
#E:/R-code/Modeling/code/FCN_clean_csvs.R
#~/Documents/R-code
source('E:/R-code2/Modeling/code/FCN_clean_csvs.R')
source('E:/R-code2/Modeling/code/FCN_plotting.R')
source('E:/R-code2/Modeling/code/FCN_sample_data.R')
source('E:/R-code2/Modeling/code/FCN_run_model_spatial_sampled.R') # OLS only
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
MT_outline <- readOGR(dsn = 'E:/R-code2/Modeling/data/shp/MatoGrossoOutline', layer = 'MatoGrossoOutline')
crs(MT_outline) <- CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0")
onset_type <- 'Gabriel_onset'
median_cell_raw <- read.csv('E:/R-code2/Modeling/data/median_onset_cell_v2.csv')
percentile5_cell_raw <- read.csv('E:/R-code2/Modeling/data/percentile5_onset_cell_v2.csv')
percentile95_cell_raw <- read.csv('E:/R-code2/Modeling/data/percentile95_onset_cell_v2.csv')
grid_1deg <- readOGR(dsn = 'E:/R-code2/Modeling/data/shp/grid_1deg', layer = 'grid_1deg')
munis <- readOGR(dsn = 'E:/R-code2/Modeling/data/shp/munis', layer = 'munis_SHP')
crs(munis) <- CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0")
cell_sf <- st_read(dsn = 'E:/R-code/Modeling/data/shp/median_onset_cell', layer = 'median_onset_cell_SHP')
min_soy_area <- 2 #km2. min area of total or SC/DC soy in cell, muni or property to be considered in model
# CSV DATA -----------------------------------------------------------------------------------------------------------------
# median cell
median_cell <- median_cell_raw %>% delete_cols_median_cell() %>%
rename_cols_median_cell()
median_cell$plant_stat_type <- rep('median', nrow(median_cell))
# percentiles
percentile5_cell <- percentile5_cell_raw %>% rename_cols_percentile_cell()
percentile95_cell <- percentile95_cell_raw %>% rename_cols_percentile_cell()
# SF DATA ------------------------------------------------------------------------------------------------
# get cell_ID column for median
cell_sf$cell_ID <- median_cell$cell_ID
cell_sf$cell_ID <- sapply(as.character(cell_sf$cell_ID), clean_cell_ID)
# join median, percentile data to cell_sf
# cell_sf has median information, but copy it and put in percentile info for DC and SC plant
cell_sf$plant_stat_type <- rep("median", nrow(cell_sf))
cell_sf_percentile5 <- cell_sf
cell_sf_percentile5$SC_plant <- percentile5_cell$SC_plant
cell_sf_percentile5$DC_plant <- percentile5_cell$DC_plant
cell_sf_percentile5$plant_stat_type <- rep("percentile5", nrow(cell_sf_percentile5))
cell_sf_percentile95 <- cell_sf
cell_sf_percentile95$SC_plant <- percentile95_cell$SC_plant
cell_sf_percentile95$DC_plant <- percentile95_cell$DC_plant
cell_sf_percentile95$plant_stat_type <- rep("percentile95", nrow(cell_sf_percentile95))
cell_sf <- rbind(cell_sf, cell_sf_percentile5, cell_sf_percentile95)
cell_sf_tidy <- cell_sf %>% tidy_by_intensity_plant("SC_plant", "DC_plant") %>%
#tidy_by_intensity_delay("SC_delay", "DC_delay") %>%
dplyr::select(-c(SC_harvest, DC_harvest)) %>%
categorize_regions_cell_sf_tidy() # categorize cells into four regions
cell_sf_tidy$year_index <- cell_sf_tidy$year - 2003
cell_sf_tidy$year_factor <- as.factor(cell_sf_tidy$year)
cell_sf_tidy <- cell_sf_tidy %>%  drop_na
cell_sf_tidy$delay <- cell_sf_tidy$plant - cell_sf_tidy$onset
# label which cells were planted before onset and filter for only before onset
cell_sf_tidy$beforeonset <- ifelse(cell_sf_tidy$onset > cell_sf_tidy$plant, 1, 0)
cell_sf_tidy <-  cell_sf_tidy[cell_sf_tidy$beforeonset == 0,]
# split into SC and DC cells
cell_sf_tidy_SC <- cell_sf_tidy[cell_sf_tidy$intensity == "SC",]
cell_sf_tidy_DC <- cell_sf_tidy[cell_sf_tidy$intensity == "DC",]
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = TRUE, year_oi = 2012, do_elim_year = TRUE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = TRUE, year_oi = 2012, do_elim_year = TRUE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE, year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE, year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE, year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE, year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE, year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE, year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE, year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE, year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE, year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE, year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = FALSE, year_oi = 2012, do_elim_year = FALSE,
chosen_intensity = "DC")
library(plm) # for FE and FE
library(lme4) # for lmer()
## OLS
# ols_results <- run_OLS(full_data = cell_sf_tidy_DC,
#                         predictors = c("onset",
#                           "lat", "region", # for spatial effects
#                           "year_index" # for time effects
#                           ),
#                     y.var = "plant", plant_stat = "median",
#                     grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
#                     plot_samples = FALSE, plot_model_evals = TRUE,
#                     year_oi = 2012, do_elim_year = FALSE,
#                     chosen_intensity = "DC")
#
# print(ols_results)
# FE
source('E:/R-code2/Modeling/code/FCN_run_any_model_spatial_sampled.R') # OLS, FE, RE and ME
fe_results <- run_any_model(full_data = cell_sf_tidy_DC, model_type = "FE", predictors = c("onset", "year_index"),
ME_randomEffects = character(0), FE_RE_effect = c("cell_ID"),
y.var = "plant", plant_stat = "median",
grid_size = 0.75, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = FALSE, plot_model_evals = TRUE, year_oi = 2012, do_elim_year = TRUE,
chosen_intensity = "DC")
